<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Catálogo de Películas</title>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .movie-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 20px;
        }
        .movie-card {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            overflow: hidden;
            transition: transform 0.3s;
            cursor: pointer;
        }
        .movie-card:hover {
            transform: scale(1.05);
        }
        .movie-card img {
            width: 100%;
            height: 270px;
            object-fit: cover;
        }
        .movie-title {
            padding: 10px;
            text-align: center;
            font-size: 14px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        #video-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        #video-player {
            max-width: 90%;
            max-height: 80%;
        }
        .close-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            color: white;
            font-size: 30px;
            cursor: pointer;
        }
        #search {
            width: 100%;
            padding: 10px;
            margin-bottom: 20px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div class="container">
        <input type="text" id="search" placeholder="Buscar película..." oninput="filterMovies()">
        <div id="movie-grid" class="movie-grid"></div>
    </div>

    <div id="video-modal" onclick="closeVideo()">
        <span class="close-btn">&times;</span>
        <video id="video-player" controls></video>
    </div>

    <script>
        const videoModal = document.getElementById('video-modal');
        const videoPlayer = document.getElementById('video-player');
        const movieGrid = document.getElementById('movie-grid');

        // Películas en formato M3U8
        const MOVIES = `#EXTINF:-1 tvg-id="" tvg-name="Rápidos y Furiosos 1" tvg-logo="https://cuevana.pro/resize/200/storage/4398/YgUlyTwWgoPvgyQBV8xKqX4WQMqa8m0MuFezodqf.jpg" group-title="⭐️Rápidos y Furiosos 1
https://as9p3ktgpeiv.milocdn.com/hls2/01/00972/gwnts9zhn8io_l/index-v1-a1.m3u8?t=bowLadwTBL5kD44fsjA_0FXVR8vzeIwtr2_ZgPKRgZI&s=1743024170&e=129600&f=10169443&srv=MQWnAzamlVSnS&i=0.4&sp=500&p1=MQWnAzamlVSnS&p2=MQWnAzamlVSnS&asn=273133
#EXTINF:-1 tvg-id="" tvg-name="Más rápido, más furioso" tvg-logo="https://image.tmdb.org/t/p/w300/fZtSG5a6i5Ca39WQylLVmvWI5b.jpg" group-title="⭐️Más rápido, más furioso
https://cukooifnwbux.premilkyway.com/hls2/01/04819/ns5ijsm5twny_,l,n,.urlset/index-f2-v1-a1.m3u8?t=btj1x-j7PMDjiaE_tSNL71entbmxy5KF_BrVOptdMYI&s=1743024467&e=129600&f=24099778&srv=3FjgDmcnea8S35m&i=0.4&sp=500&p1=3FjgDmcnea8S35m&p2=3FjgDmcnea8S35m&asn=273133
#EXTINF:-1 tvg-id="" tvg-name="Rápidos y furiosos 3: Desafío Tokyo" tvg-logo="https://cuevana.pro/resize/200/storage/4402/xOrbjnvdV5sAruXfW50pDQQAjiendAhmvcuCZCet.jpg" group-title="⭐️Rápidos y furiosos 3: Desafío Tokyo
https://vwhuvrleqt9z.milocdn.com/hls2/01/00975/az58aupqwq1y_l/index-v1-a1.m3u8?t=0KGHA7bkRHgV3BJKNV9KlzAh0fL8PnYx5FEPus16iwg&s=1743024681&e=129600&f=10167569&srv=o5h0LGNZUCVjU&i=0.4&sp=500&p1=o5h0LGNZUCVjU&p2=o5h0LGNZUCVjU&asn=273133`;

        function parseMovies() {
            const lines = MOVIES.split('\n');
            const movies = [];

            for (let i = 0; i < lines.length; i++) {
                if (lines[i].startsWith('#EXTINF')) {
                    const info = lines[i].split('"');
                    const title = info[3];
                    const poster = info[7];
                    const videoUrl = lines[i + 1].trim();

                    movies.push({ title, poster, videoUrl });
                }
            }

            return movies;
        }

        function renderMovies(movies) {
            movieGrid.innerHTML = '';
            movies.forEach(movie => {
                const movieCard = document.createElement('div');
                movieCard.classList.add('movie-card');
                movieCard.innerHTML = `
                    <img src="${movie.poster}" alt="${movie.title}">
                    <div class="movie-title">${movie.title}</div>
                `;
                movieCard.onclick = () => playMovie(movie.videoUrl);
                movieGrid.appendChild(movieCard);
            });
        }

        function playMovie(url) {
            videoModal.style.display = 'flex';
            videoPlayer.src = '';  // Limpiar fuente anterior

            // Soporte para HLS
            if (Hls.isSupported() && url.includes('.m3u8')) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoPlayer);
                hls.on(Hls.Events.MANIFEST_PARSED, () => {
                    videoPlayer.play();
                });
            } 
            // Soporte para MP4 directo
            else if (url.includes('.mp4')) {
                videoPlayer.src = url;
                videoPlayer.play();
            }
            // Fallback para otros formatos
            else {
                videoPlayer.src = url;
                videoPlayer.play();
            }
        }

        function filterMovies() {
            const searchTerm = document.getElementById('search').value.toLowerCase();
            const movies = parseMovies();
            const filteredMovies = movies.filter(movie => 
                movie.title.toLowerCase().includes(searchTerm)
            );
            renderMovies(filteredMovies);
        }

        function closeVideo() {
            videoModal.style.display = 'none';
            videoPlayer.pause();
        }

        // Inicializar catálogo
        document.addEventListener('DOMContentLoaded', () => {
            renderMovies(parseMovies());
        });
    </script>
</body>
</html>
