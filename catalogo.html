<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Catálogo de Películas</title>
</head>
<body>
    <h1>Catálogo de Películas</h1>
    <div id="catalogo"></div>
   <button onclick="window.location.href='dashboard.html'">Regresar al Dashboard</button>



    <script>
        const API_URL = "https://tihvqxujcqladqxucugf.supabase.co/rest/v1/peliculas";
        const API_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRpaHZxeHVqY3FsYWRxeHVjdWdmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDMyMDYwNTUsImV4cCI6MjA1ODc4MjA1NX0.p9lMEnhHfA10JSiGv9jJZHj0Zf5SCnZFtER5GYvqI5g"; 

        async function cargarPeliculas() {
            try {
                const respuesta = await fetch(`${API_URL}?select=*`, {
                    headers: {
                        "apikey": API_KEY,
                        "Authorization": `Bearer ${API_KEY}`
                    }
                });

                if (!respuesta.ok) {
                    throw new Error("Error al obtener datos");
                }

                const peliculas = await respuesta.json();
                console.log("Películas recibidas:", peliculas);

                const catalogoDiv = document.getElementById("catalogo");
                catalogoDiv.innerHTML = "";

                peliculas.forEach(pelicula => {
                    const peliculaDiv = document.createElement("div");
                    peliculaDiv.innerHTML = `
                        <h3>${pelicula.nombre}</h3>
                        <img src="${pelicula.imagen}" alt="${pelicula.nombre}" style="width:150px;">
                        <p>${pelicula.resena}</p>
                        <a href="player.html?id=${pelicula.id}&url=${encodeURIComponent(pelicula.url)}">Ver Película</a>
                        <hr>
                    `;
                    catalogoDiv.appendChild(peliculaDiv);
                });

            } catch (error) {
                console.error("Error cargando películas:", error);
            }
        }

        cargarPeliculas();
    </script>
</body>
</html>
